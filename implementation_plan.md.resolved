# Link Frameworks to Tasks

## Goal Description
Enable users to link a "Framework" to each Task. This allows tracking "Actual Time vs Target Allocation".
- **Database**: Add `framework_id` to `planned_tasks`.
- **UI**: Add "Framework" dropdown to "Add Task" modal.
- **Analysis**: Show "Framework Analysis" (Actual vs Target %) in [Timesheet.jsx](file:///home/aravinth/Anti%20Gravity/src/pages/Timesheet.jsx).

## Proposed Changes

### [tasks.php](file:///home/aravinth/Anti Gravity/public/api/tasks.php)
#### Database Migration (Auto)
- Check if `framework_id` column exists in `planned_tasks`. If not, add it (`INT DEFAULT NULL`).

#### API Logic
- **POST**: distinct `framework_id` from payload and insert it.
- **GET**: Join with `work_allocations` table to fetch `category_name` and `color` (if any, or just name) for display.

### [Tasks.jsx](file:///home/aravinth/Anti Gravity/src/pages/Tasks.jsx)
#### Add Task Modal
- Fetch frameworks using `getFrameworks()` (need to export this or use `axios`).
- Add `<select>` dropdown for Framework.
- Pass `framework_id` to `createTask`.

### [Timesheet.jsx](file:///home/aravinth/Anti Gravity/src/pages/Timesheet.jsx)
#### Framework Analysis View
- Add a section (or toggle) to view "Framework Breakdown".
- **Logic**:
    1.  Get all entries for current view (Day/Week/Month).
    2.  Group by `framework_id`.
    3.  Sum duration.
    4.  Compare with `framework.percentage` (Target).
- **Display**: Table or progress bars showing "Business Analysis: 30% (Target 50%) - Under".

## Verification Plan
1.  **DB**: existing [tasks.php](file:///home/aravinth/Anti%20Gravity/public/api/tasks.php) call should trigger migration.
2.  **Creation**: Create a task "Strategy Meeting" linked to "Company operations".
3.  **Display**: Verify task list shows the framework name/tag.
4.  **Analysis**: Log 1 hour for this task. Go to Timesheet. Check if "Company operations" shows ~1 hour and accurate %.
